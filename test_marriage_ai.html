<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åˆå©šAIåˆ†ææµ‹è¯•</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        body {
            background: #1a1a1a;
            color: #fff;
            font-family: Arial, sans-serif;
            padding: 20px;
        }
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .test-info {
            background: #004455;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 30px;
        }
        .test-section {
            background: #2a2a2a;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
        }
        .form-row {
            display: flex;
            gap: 15px;
            margin: 15px 0;
        }
        .form-group {
            flex: 1;
        }
        label {
            display: block;
            margin-bottom: 5px;
            color: #00d4ff;
        }
        select, input {
            width: 100%;
            padding: 8px;
            background: #333;
            border: 1px solid #555;
            color: #fff;
            border-radius: 4px;
        }
        .cyber-button {
            background: linear-gradient(45deg, #00d4ff, #0099cc);
            color: #000;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            margin: 10px 5px;
            position: relative;
            overflow: hidden;
        }
        .cyber-button:hover {
            background: linear-gradient(45deg, #00ffff, #00d4ff);
        }
        .cyber-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }
        .result-panel {
            background: #1e1e1e;
            border-radius: 12px;
            padding: 20px;
            margin-top: 20px;
            border: 1px solid #333;
        }
        .ai-analysis-section {
            margin-top: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            border-radius: 12px;
            border: 1px solid #00d4ff;
        }
        .ai-description {
            color: #ccc;
            margin-bottom: 20px;
            font-style: italic;
        }
        .ai-marriage-processing {
            background: #2a2a2a;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            text-align: center;
        }
        .processing-animation {
            margin-bottom: 15px;
        }
        .cyber-loader {
            width: 40px;
            height: 40px;
            border: 3px solid #333;
            border-top: 3px solid #00d4ff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .ai-marriage-output {
            background: #1a1a1a;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #00d4ff;
            margin: 20px 0;
            white-space: pre-wrap;
            line-height: 1.6;
        }
        .ai-error {
            background: #4a1a1a;
            padding: 20px;
            border-radius: 8px;
            border-left: 4px solid #ff4444;
            text-align: center;
        }
        .error-icon {
            font-size: 2em;
            margin-bottom: 10px;
        }
        .error-message {
            font-weight: bold;
            margin-bottom: 10px;
        }
        .error-suggestion {
            color: #ccc;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="test-info">
            <h1>ğŸ¤– åˆå©šAIåˆ†æåŠŸèƒ½æµ‹è¯•</h1>
            <p>æµ‹è¯•æ–°å¢çš„å¤§æ¨¡å‹åˆå©šæ·±åº¦åˆ†æåŠŸèƒ½</p>
            <p><strong>æµ‹è¯•æ­¥éª¤ï¼š</strong></p>
            <ol>
                <li>å¡«å†™ç”·å¥³åŒæ–¹åŸºæœ¬ä¿¡æ¯</li>
                <li>ç‚¹å‡»"å¼€å§‹åˆå©š"ç”ŸæˆåŸºç¡€åˆ†æ</li>
                <li>åœ¨ç»“æœä¸­ç‚¹å‡»"ç”ŸæˆAIæ·±åº¦åˆ†æ"</li>
                <li>æŸ¥çœ‹AIåˆ†æç»“æœå’Œå¤åˆ¶åŠŸèƒ½</li>
            </ol>
            <p><strong>æ³¨æ„ï¼š</strong>éœ€è¦é…ç½®æœ‰æ•ˆçš„AI APIå¯†é’¥æ‰èƒ½ä½¿ç”¨AIåˆ†æåŠŸèƒ½</p>
            <button class="cyber-button" onclick="showAIConfig()">é…ç½®AIè®¾ç½®</button>
            <button class="cyber-button" onclick="testAIConnection()">æµ‹è¯•AIè¿æ¥</button>
        </div>

        <form id="hehun-form" class="cyber-form">
            <div class="test-section">
                <h3>ç”·æ–¹ä¿¡æ¯</h3>
                <div class="form-group">
                    <label>å§“å</label>
                    <input type="text" name="maleName" value="å¼ ä¸‰" required>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>å‡ºç”Ÿå¹´ä»½</label>
                        <select name="maleBirthYear" required>
                            <option value="">é€‰æ‹©å¹´ä»½</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>å‡ºç”Ÿæœˆä»½</label>
                        <select name="maleBirthMonth" required>
                            <option value="">é€‰æ‹©æœˆä»½</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>å‡ºç”Ÿæ—¥æœŸ</label>
                        <select name="maleBirthDay" required>
                            <option value="">é€‰æ‹©æ—¥æœŸ</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>å‡ºç”Ÿæ—¶é—´</label>
                        <select name="maleBirthHour" required>
                            <option value="">æ—¶</option>
                            <option value="8" selected>08æ—¶</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>å‡ºç”Ÿåˆ†é’Ÿ</label>
                        <select name="maleBirthMinute" required>
                            <option value="0" selected>00åˆ†</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>å‡ºç”Ÿçœä»½</label>
                        <select name="maleBirthProvince" required>
                            <option value="">é€‰æ‹©çœä»½</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>å‡ºç”ŸåŸå¸‚</label>
                        <select name="maleBirthCity" required>
                            <option value="">é€‰æ‹©åŸå¸‚</option>
                        </select>
                    </div>
                </div>
            </div>

            <div class="test-section">
                <h3>å¥³æ–¹ä¿¡æ¯</h3>
                <div class="form-group">
                    <label>å§“å</label>
                    <input type="text" name="femaleName" value="æå››" required>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>å‡ºç”Ÿå¹´ä»½</label>
                        <select name="femaleBirthYear" required>
                            <option value="">é€‰æ‹©å¹´ä»½</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>å‡ºç”Ÿæœˆä»½</label>
                        <select name="femaleBirthMonth" required>
                            <option value="">é€‰æ‹©æœˆä»½</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>å‡ºç”Ÿæ—¥æœŸ</label>
                        <select name="femaleBirthDay" required>
                            <option value="">é€‰æ‹©æ—¥æœŸ</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>å‡ºç”Ÿæ—¶é—´</label>
                        <select name="femaleBirthHour" required>
                            <option value="">æ—¶</option>
                            <option value="14" selected>14æ—¶</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>å‡ºç”Ÿåˆ†é’Ÿ</label>
                        <select name="femaleBirthMinute" required>
                            <option value="30" selected>30åˆ†</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>å‡ºç”Ÿçœä»½</label>
                        <select name="femaleBirthProvince" required>
                            <option value="">é€‰æ‹©çœä»½</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>å‡ºç”ŸåŸå¸‚</label>
                        <select name="femaleBirthCity" required>
                            <option value="">é€‰æ‹©åŸå¸‚</option>
                        </select>
                    </div>
                </div>
            </div>

            <button type="submit" class="cyber-button">
                <span>å¼€å§‹åˆå©š</span>
            </button>
        </form>

        <div class="result-panel" id="hehun-result" style="display: none;">
            <div class="result-content">
                <!-- åˆå©šç»“æœå°†åœ¨è¿™é‡Œæ˜¾ç¤º -->
            </div>
        </div>
    </div>

    <script src="js/bazi-calculator.js"></script>
    <script src="js/ziwei-calculator.js"></script>
    <script src="js/name-calculator.js"></script>
    <script src="js/marriage-calculator.js"></script>
    <script src="js/main.js"></script>
    <script>
        // åˆå§‹åŒ–åº”ç”¨
        const app = new CyberFortune();

        // è®¾ç½®æµ‹è¯•ç”¨çš„AIé…ç½®
        function setupTestAIConfig() {
            const testConfig = {
                apiUrl: 'https://api.openai.com/v1/chat/completions',
                apiKey: 'your-api-key-here',
                model: 'gpt-3.5-turbo'
            };
            localStorage.setItem('cyberFortune_globalConfig', JSON.stringify(testConfig));
            console.log('æµ‹è¯•AIé…ç½®å·²è®¾ç½®:', testConfig);
        }

        // é¡µé¢åŠ è½½æ—¶è®¾ç½®æµ‹è¯•é…ç½®
        setupTestAIConfig();
        
        // è®¾ç½®é»˜è®¤å€¼
        document.addEventListener('DOMContentLoaded', function() {
            // è®¾ç½®é»˜è®¤å¹´ä»½
            const maleYear = document.querySelector('select[name="maleBirthYear"]');
            const femaleYear = document.querySelector('select[name="femaleBirthYear"]');
            if (maleYear && femaleYear) {
                setTimeout(() => {
                    maleYear.value = '1990';
                    femaleYear.value = '1992';
                    
                    // è®¾ç½®é»˜è®¤æœˆä»½
                    const maleMonth = document.querySelector('select[name="maleBirthMonth"]');
                    const femaleMonth = document.querySelector('select[name="femaleBirthMonth"]');
                    if (maleMonth && femaleMonth) {
                        maleMonth.value = '5';
                        femaleMonth.value = '8';
                        
                        // è§¦å‘æœˆä»½å˜åŒ–äº‹ä»¶æ¥æ›´æ–°æ—¥æœŸ
                        maleMonth.dispatchEvent(new Event('change'));
                        femaleMonth.dispatchEvent(new Event('change'));
                        
                        // è®¾ç½®é»˜è®¤æ—¥æœŸ
                        setTimeout(() => {
                            const maleDay = document.querySelector('select[name="maleBirthDay"]');
                            const femaleDay = document.querySelector('select[name="femaleBirthDay"]');
                            if (maleDay && femaleDay) {
                                maleDay.value = '15';
                                femaleDay.value = '20';
                            }
                        }, 100);
                    }
                    
                    // è®¾ç½®é»˜è®¤çœä»½
                    const maleProv = document.querySelector('select[name="maleBirthProvince"]');
                    const femaleProv = document.querySelector('select[name="femaleBirthProvince"]');
                    if (maleProv && femaleProv) {
                        maleProv.value = 'åŒ—äº¬å¸‚';
                        femaleProv.value = 'ä¸Šæµ·å¸‚';
                        
                        // è§¦å‘çœä»½å˜åŒ–äº‹ä»¶æ¥æ›´æ–°åŸå¸‚
                        maleProv.dispatchEvent(new Event('change'));
                        femaleProv.dispatchEvent(new Event('change'));
                    }
                }, 500);
            }
        });

        // æ˜¾ç¤ºAIé…ç½®å¯¹è¯æ¡†
        function showAIConfig() {
            const config = JSON.parse(localStorage.getItem('cyberFortune_globalConfig') || '{}');
            const apiUrl = prompt('è¯·è¾“å…¥APIåœ°å€:', config.apiUrl || 'https://api.openai.com/v1/chat/completions');
            const apiKey = prompt('è¯·è¾“å…¥APIå¯†é’¥:', config.apiKey || '');
            const model = prompt('è¯·è¾“å…¥æ¨¡å‹åç§°:', config.model || 'gpt-3.5-turbo');

            if (apiUrl && apiKey && model) {
                const newConfig = { apiUrl, apiKey, model };
                localStorage.setItem('cyberFortune_globalConfig', JSON.stringify(newConfig));
                alert('AIé…ç½®å·²ä¿å­˜');
                console.log('AIé…ç½®å·²æ›´æ–°:', newConfig);
            }
        }

        // æµ‹è¯•AIè¿æ¥
        function testAIConnection() {
            const config = JSON.parse(localStorage.getItem('cyberFortune_globalConfig') || '{}');
            if (!config.apiKey) {
                alert('è¯·å…ˆé…ç½®AIè®¾ç½®');
                return;
            }

            console.log('å½“å‰AIé…ç½®:', config);
            alert('AIé…ç½®æ£€æŸ¥å®Œæˆï¼Œè¯·æŸ¥çœ‹æ§åˆ¶å°è¾“å‡º');
        }
    </script>
</body>
</html>
